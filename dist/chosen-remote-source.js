/*
 * chosen-remote-source
 * @version v0.9.0
 * @link http://github.com/westonganger/chosen-remote-source
 * @license MIT
 */
!function(e){var t=".chosen-remote-source",l={delay:250,event:"input",label_field:"label",value_field:"value",search_param:"q",selected_param:"selected"},a=e("<select></select>");a.chosen(),Object.getPrototypeOf(a.data("chosen")).show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.default_text===this.search_field.val()&&this.search_field.val(""),this.search_field.removeClass("default"))};var r=function(){var t=e(this),l=t.val(),a=t.closest(".chosen-container").prev("select"),r=a.data("chosen-remote-source-opts"),s=a.val();if(a[0].hasAttribute("multiple"))for(var i=0;i<s.length;i++)selected_opts+=a.find("option[value='"+s[i]+"']")[0].outerHTML;else s&&(selected_opts+=a.find("option[value='"+s+"']")[0].outerHTML);e.ajax({url:r.url,dataType:"json",data:{q:l,selected:s},type:"GET"}).done((function(e){for(var t="",l=0;l<e.length;l++)t+="<option value='"+e[l][t.value_field]+"'>"+e[l][t.label_field]+"</option>";selected_opts&&(t+=selected_opts),a.html(t).val(s).trigger("chosen:updated")}))};e.fn.chosenRemoteSource=function(a){if(!a.url)return console.error("Error: url must be defined"),!1;if(a.event){events_array=a.event.split(" ");for(var s="",i=0;i<events_array.length;i++)0!==i&&(s+=" "),s+=events_array[i]+t;a.event=null}else s="input"+t;var o=this.filter((function(t,l){return e(l).data("chosen")})),n={};n.url=a.url||l.url,n.label_field=a.label_field||l.label_field,n.value_field=a.value_field||l.value_field,o.data("chosen-remote-source-opts",n);var u=function(e,t){var l;return function(){var a=this,r=arguments,s=function(){l=null,t.apply(a,r)};clearTimeout(l),l=setTimeout(s,e)}}(a.delay||l.delay,r);return o.off(t),o.on(s,"input.chosen-search-input",u),this}}(window.jQuery||window.Zepto||window.$);
